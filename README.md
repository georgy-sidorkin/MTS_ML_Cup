# MTS_ML_Cup
https://ods.ai/competitions/mtsmlcup

https://www.kaggle.com/datasets/nfedorov/mts-ml-cookies

Соревнование от МТС Digital Big Data по определению пола/возраста владельца cookie.

Метрики соревнования:
* ROC-AUC – для определения пола, f1 weighted – для определения возраста. 
* Все решения рассчитываются по формуле -  2 * f1_weighted(по 6 возрастным бакетам) + gini по полу.
* Возрастные бакеты( Класс 1 — 19-25, Класс 2 — 26-35, Класс 3 — 36-45, Класс 4 — 46-55, Класс 5 — 56-65, Класс 6 — 66+).

Описание колонок файла с данными:
* 'region_name' – Регион
* 'city_name' – Населенный пункт
* 'cpe_manufacturer_name' – Производитель устройства
* 'cpe_model_name' – Модель устройства
* 'url_host' – Домен, с которого пришел рекламный запрос
* 'cpe_type_cd' – Тип устройства (смартфон или что-то другое)
* 'Cpe_model_os_type' – Операционка на устройстве
* 'price' – Оценка цены устройства
* 'date' – Дата
* 'part_of_day' – Время дня (утро, вечер, итд)
* 'request_cnt' – Число запросов одного пользователя за время дня (поле part_of_day)
* 'user_id' – ID пользователя

Описание колонок файла с таргетами:

* 'age' – Возраст пользователя
* 'is_male' – Признак пользователя : мужчина (1-Да, 0-Нет)
* 'user_id' – ID пользователя

Предобработка и аггрегация данных выполнена в файле **preprocessing.py**. 

Данная работа была разделена на несколько jupyter ноутбуков:
1. _EDA.ipynb_ - исследовательская часть
2. _baseline.ipynb_ - бейзлайн модели
3. _create_embeddings.ipynb_ - создание эмбеддингов для дальнейшего их использования в качестве фич
4. _baseline_embeddings.ipynb_ - бейзлан модели с эмбеддингами
5. _model_tuning.ipynb_ - тюнинг наиболее перспективных моделей
6. _gender_prediction_stacking.ipynb_ - стекинг моделей для предсказания пола
